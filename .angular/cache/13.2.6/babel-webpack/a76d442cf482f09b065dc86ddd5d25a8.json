{"ast":null,"code":"import _asyncToGenerator from \"D:\\\\roadcast-web\\\\jfl-tracking\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport __NG_CLI_RESOURCE__0 from \"./customer-tracking-page.component.html?ngResource\";\nimport __NG_CLI_RESOURCE__1 from \"./customer-tracking-page.component.css?ngResource\";\nimport { Component } from '@angular/core';\nimport { OrderService } from \"../order.service\";\nimport { Router } from \"@angular/router\";\nimport { FormBuilder, Validators } from \"@angular/forms\";\nimport { interval } from \"rxjs\";\nlet CustomerTrackingPageComponent = class CustomerTrackingPageComponent {\n  constructor(orderService, router, fb) {\n    this.orderService = orderService;\n    this.router = router;\n    this.fb = fb;\n    this.order = {\n      id: '',\n      rider: {\n        name: ''\n      },\n      delivery_address: {\n        google_address: ''\n      }\n    };\n    this.feedbackorder = '';\n    this.rating = {};\n    this.rating3 = 0;\n    this.form = this.fb.group({\n      rating1: ['', Validators.required],\n      rating2: [4]\n    });\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this.orderService.init().then();\n      _this.order = _this.orderService.order;\n      _this.rating = _this.orderService.rating;\n\n      _this.pollingData();\n    })();\n  }\n\n  pollingData() {\n    this.sub = interval(4000).subscribe(() => {\n      this.orderService.init().then();\n      this.order = this.orderService.order;\n    });\n\n    if (this.order.status_name === 'delivered' || this.order.status_name === 'cancelled') {\n      this.sub.unsubscribe();\n    }\n  }\n\n  feedback() {\n    var _this2 = this;\n\n    const api_url = 'https://jfl-api-dev.roadcast.co.in/api/v1/';\n    fetch(api_url + 'order/order_feedback/' + `${this.order.id}`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        stars: this.rating3,\n        feedback: this.feedbackorder,\n        customer_id: this.order.customer_id,\n        rider_id: this.order.rider_id\n      })\n    }).then( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (res) {\n        const resData = yield res.json();\n        _this2.feedbackStatus = resData.status;\n        yield _this2.orderService.init();\n        _this2.order = _this2.orderService.order;\n        _this2.rating = _this2.orderService.rating;\n      });\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n  }\n\n};\n\nCustomerTrackingPageComponent.ctorParameters = () => [{\n  type: OrderService\n}, {\n  type: Router\n}, {\n  type: FormBuilder\n}];\n\nCustomerTrackingPageComponent = __decorate([Component({\n  selector: 'app-customer-tracking-page',\n  template: __NG_CLI_RESOURCE__0,\n  styles: [__NG_CLI_RESOURCE__1]\n})], CustomerTrackingPageComponent);\nexport { CustomerTrackingPageComponent };","map":{"version":3,"sources":["D:/roadcast-web/jfl-tracking/src/app/customer-tracking-page/customer-tracking-page.component.ts"],"names":["__decorate","__NG_CLI_RESOURCE__0","__NG_CLI_RESOURCE__1","Component","OrderService","Router","FormBuilder","Validators","interval","CustomerTrackingPageComponent","constructor","orderService","router","fb","order","id","rider","name","delivery_address","google_address","feedbackorder","rating","rating3","form","group","rating1","required","rating2","ngOnInit","init","then","pollingData","sub","subscribe","status_name","unsubscribe","feedback","api_url","fetch","method","headers","body","JSON","stringify","stars","customer_id","rider_id","res","resData","json","feedbackStatus","status","ctorParameters","type","selector","template","styles"],"mappings":"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","sourcesContent":["import { __decorate } from \"tslib\";\r\nimport __NG_CLI_RESOURCE__0 from \"./customer-tracking-page.component.html?ngResource\";\r\nimport __NG_CLI_RESOURCE__1 from \"./customer-tracking-page.component.css?ngResource\";\r\nimport { Component } from '@angular/core';\r\nimport { OrderService } from \"../order.service\";\r\nimport { Router } from \"@angular/router\";\r\nimport { FormBuilder, Validators } from \"@angular/forms\";\r\nimport { interval } from \"rxjs\";\r\nlet CustomerTrackingPageComponent = class CustomerTrackingPageComponent {\r\n    constructor(orderService, router, fb) {\r\n        this.orderService = orderService;\r\n        this.router = router;\r\n        this.fb = fb;\r\n        this.order = {\r\n            id: '',\r\n            rider: {\r\n                name: ''\r\n            },\r\n            delivery_address: {\r\n                google_address: ''\r\n            }\r\n        };\r\n        this.feedbackorder = '';\r\n        this.rating = {};\r\n        this.rating3 = 0;\r\n        this.form = this.fb.group({\r\n            rating1: ['', Validators.required],\r\n            rating2: [4]\r\n        });\r\n    }\r\n    async ngOnInit() {\r\n        await this.orderService.init().then();\r\n        this.order = this.orderService.order;\r\n        this.rating = this.orderService.rating;\r\n        this.pollingData();\r\n    }\r\n    pollingData() {\r\n        this.sub = interval(4000).subscribe(() => {\r\n            this.orderService.init().then();\r\n            this.order = this.orderService.order;\r\n        });\r\n        if (this.order.status_name === 'delivered' || this.order.status_name === 'cancelled') {\r\n            this.sub.unsubscribe();\r\n        }\r\n    }\r\n    feedback() {\r\n        const api_url = 'https://jfl-api-dev.roadcast.co.in/api/v1/';\r\n        fetch(api_url + 'order/order_feedback/' + `${this.order.id}`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({\r\n                stars: this.rating3,\r\n                feedback: this.feedbackorder,\r\n                customer_id: this.order.customer_id,\r\n                rider_id: this.order.rider_id,\r\n            })\r\n        }).then(async (res) => {\r\n            const resData = await res.json();\r\n            this.feedbackStatus = resData.status;\r\n            await this.orderService.init();\r\n            this.order = this.orderService.order;\r\n            this.rating = this.orderService.rating;\r\n        });\r\n    }\r\n};\r\nCustomerTrackingPageComponent.ctorParameters = () => [\r\n    { type: OrderService },\r\n    { type: Router },\r\n    { type: FormBuilder }\r\n];\r\nCustomerTrackingPageComponent = __decorate([\r\n    Component({\r\n        selector: 'app-customer-tracking-page',\r\n        template: __NG_CLI_RESOURCE__0,\r\n        styles: [__NG_CLI_RESOURCE__1]\r\n    })\r\n], CustomerTrackingPageComponent);\r\nexport { CustomerTrackingPageComponent };\r\n"]},"metadata":{},"sourceType":"module"}